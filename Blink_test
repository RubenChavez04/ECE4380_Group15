#include <stdint.h>

#define PERIPH_BASE     0x40000000
#define APB2_BASE       (PERIPH_BASE + 0x10000)
#define AHB_BASE        (PERIPH_BASE + 0x20000)

#define RCC_BASE        (AHB_BASE  + 0x1000)
#define GPIOC_BASE      (APB2_BASE + 0x1000)

#define RCC_APB2ENR     (*(volatile uint32_t *)(RCC_BASE  + 0x18))
#define GPIOC_CRH       (*(volatile uint32_t *)(GPIOC_BASE + 0x04))
#define GPIOC_ODR       (*(volatile uint32_t *)(GPIOC_BASE + 0x0C))

void delay(volatile uint32_t count)
{
    while (count--) __asm__("nop");
}

int main(void)
{
    // Enable GPIOC clock
    RCC_APB2ENR |= (1 << 4);

    // Configure PC13 as output (push-pull, 2 MHz)
    GPIOC_CRH &= ~(0xF << 20);   // Clear CNF13 + MODE13
    GPIOC_CRH |=  (0x2 << 20);   // MODE13 = 2 MHz output

    while (1)
    {
        GPIOC_ODR ^= (1 << 13);
        delay(500000);
    }
}
